{
  "$schema": "https://railway.app/railway.schema.json",
  "name": "Payload CMS + Jamstack Platform",
  "description": "A super-powered, WordPress-like CMS with a decoupled Jamstack frontend. Built with Payload CMS v3, Next.js, and PostgreSQL.",
  "services": [
    {
      "name": "postgres",
      "type": "database",
      "database": "postgresql",
      "plan": "hobby"
    },
    {
      "name": "cms",
      "type": "service",
      "source": {
        "repo": "github.com/yourusername/your-repo",
        "rootDirectory": "apps/cms"
      },
      "build": {
        "builder": "DOCKERFILE",
        "dockerfilePath": "apps/cms/Dockerfile",
        "buildContext": "."
      },
      "deploy": {
        "startCommand": "node server.js",
        "healthcheckPath": "/api/health",
        "healthcheckTimeout": 300,
        "restartPolicyType": "ON_FAILURE",
        "restartPolicyMaxRetries": 10
      },
      "env": {
        "DATABASE_URL": {
          "reference": "postgres.DATABASE_URL",
          "description": "PostgreSQL connection string from the database service"
        },
        "PAYLOAD_SECRET": {
          "generate": true,
          "generator": "secret",
          "description": "Secret key for Payload CMS authentication and encryption"
        },
        "PAYLOAD_PUBLIC_SERVER_URL": {
          "value": "https://${{RAILWAY_PUBLIC_DOMAIN}}",
          "description": "Public URL where the CMS is accessible"
        },
        "NODE_ENV": {
          "value": "production",
          "description": "Node environment"
        },
        "NEXT_TELEMETRY_DISABLED": {
          "value": "1",
          "description": "Disable Next.js telemetry"
        }
      },
      "domains": {
        "generateDefault": true
      }
    },
    {
      "name": "web",
      "type": "service",
      "source": {
        "repo": "github.com/yourusername/your-repo",
        "rootDirectory": "apps/web"
      },
      "build": {
        "builder": "DOCKERFILE",
        "dockerfilePath": "apps/web/Dockerfile",
        "buildContext": "."
      },
      "deploy": {
        "startCommand": "node server.js",
        "healthcheckPath": "/api/revalidate",
        "healthcheckTimeout": 300,
        "restartPolicyType": "ON_FAILURE",
        "restartPolicyMaxRetries": 10
      },
      "env": {
        "DATABASE_URL": {
          "reference": "postgres.DATABASE_URL",
          "description": "PostgreSQL connection string from the database service"
        },
        "CMS_URL": {
          "reference": "cms.RAILWAY_PUBLIC_DOMAIN",
          "transform": "https://${{value}}",
          "description": "URL of the CMS service for server-side requests"
        },
        "NEXT_PUBLIC_CMS_URL": {
          "reference": "cms.RAILWAY_PUBLIC_DOMAIN",
          "transform": "https://${{value}}",
          "description": "URL of the CMS service for client-side requests"
        },
        "NEXT_PUBLIC_SITE_URL": {
          "value": "https://${{RAILWAY_PUBLIC_DOMAIN}}",
          "description": "Public URL where the frontend is accessible"
        },
        "REVALIDATION_SECRET": {
          "generate": true,
          "generator": "secret",
          "description": "Secret for on-demand revalidation webhooks"
        },
        "NODE_ENV": {
          "value": "production",
          "description": "Node environment"
        },
        "NEXT_TELEMETRY_DISABLED": {
          "value": "1",
          "description": "Disable Next.js telemetry"
        }
      },
      "domains": {
        "generateDefault": true
      }
    }
  ],
  "metadata": {
    "category": "CMS",
    "tags": ["payload", "cms", "nextjs", "jamstack", "postgresql", "headless-cms"],
    "icon": "https://raw.githubusercontent.com/payloadcms/payload/main/packages/ui/src/assets/payload-logo-light.svg",
    "demoUrl": "https://your-demo-url.railway.app",
    "repository": "https://github.com/yourusername/your-repo"
  },
  "deployment": {
    "order": ["postgres", "cms", "web"],
    "waitForHealthcheck": true
  }
}


---
/**
 * Media Block Component
 * 
 * Displays images or videos with optional caption.
 */

interface Props {
  media?: {
    url: string;
    alt?: string;
    mimeType?: string;
    width?: number;
    height?: number;
  };
  caption?: string;
  size?: 'small' | 'medium' | 'large' | 'full';
  alignment?: 'left' | 'center' | 'right';
}

const { media, caption, size = 'large', alignment = 'center' } = Astro.props;

if (!media?.url) return null;

const sizeClasses: Record<string, string> = {
  small: 'max-w-md',
  medium: 'max-w-2xl',
  large: 'max-w-4xl',
  full: 'max-w-full',
};

const alignmentClasses: Record<string, string> = {
  left: 'mr-auto',
  center: 'mx-auto',
  right: 'ml-auto',
};

const isVideo = media.mimeType?.startsWith('video/');
---

<figure class={`py-8 ${sizeClasses[size]} ${alignmentClasses[alignment]}`}>
  {isVideo ? (
    <video 
      src={media.url} 
      controls 
      class="w-full rounded-lg shadow-lg"
      width={media.width}
      height={media.height}
    />
  ) : (
    <img 
      src={media.url} 
      alt={media.alt || ''} 
      class="w-full rounded-lg shadow-lg"
      width={media.width}
      height={media.height}
      loading="lazy"
    />
  )}
  {caption && (
    <figcaption class="mt-3 text-center text-sm text-gray-500 dark:text-gray-400">
      {caption}
    </figcaption>
  )}
</figure>

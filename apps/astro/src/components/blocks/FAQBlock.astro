---
/**
 * FAQ Block Component
 * 
 * Display frequently asked questions with expandable answers.
 */

interface Props {
  heading?: string;
  items?: Array<{
    question: string;
    answer: any; // Rich text
  }>;
}

const { heading, items = [] } = Astro.props;

function renderRichText(node: any): string {
  if (!node) return '';
  if (typeof node === 'string') return node;
  if (Array.isArray(node)) return node.map(renderRichText).join('');
  
  if (node.type === 'text') {
    let text = node.text || '';
    if (node.format & 1) text = `<strong>${text}</strong>`;
    if (node.format & 2) text = `<em>${text}</em>`;
    return text;
  }
  
  const children = node.children ? renderRichText(node.children) : '';
  
  switch (node.type) {
    case 'root':
      return children;
    case 'paragraph':
      return `<p>${children}</p>`;
    default:
      return children;
  }
}
---

<section class="py-12">
  <div class="container max-w-2xl">
    {heading && (
      <h2 class="text-3xl font-bold mb-12 text-center">
        {heading}
      </h2>
    )}
    
    <div class="space-y-4">
      {items.map((item, index) => (
        <details class="rounded-lg border border-gray-200 dark:border-gray-700">
          <summary class="cursor-pointer bg-gray-50 p-4 font-semibold text-gray-900 hover:bg-gray-100 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700">
            {item.question}
          </summary>
          
          <div class="border-t border-gray-200 bg-white p-4 text-gray-700 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300">
            {item.answer?.root ? (
              <div set:html={renderRichText(item.answer.root)} />
            ) : (
              <p>{item.answer}</p>
            )}
          </div>
        </details>
      ))}
    </div>
  </div>
</section>

